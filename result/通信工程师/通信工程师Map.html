<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
    <script type="text/javascript" src="http://code.jquery.com/jquery-latest.js"></script>
    <script type="text/javascript" src="http://api.map.baidu.com/api?v=2.0&ak=IkE8Vh4DQ86PfCXajy1Q0hoDYqHElBco"></script>
    <script type="text/javascript" src="http://api.map.baidu.com/library/Heatmap/2.0/src/Heatmap_min.js"></script>
    <title>热力图功能示例</title>
    <style type="text/css">
		ul,li{list-style: none;margin:0;padding:0;float:left;}
		html{height:100%}
		body{height:100%;margin:0px;padding:0px;font-family:"微软雅黑";}
		#container{height:700px;width:100%;}
		#r-result{width:100%;}
    </style>
</head>
<body>
	<div id="container"></div>
	<div id="r-result">
		<input type="button"  onclick="openHeatmap();" value="显示热力图"/><input type="button"  onclick="closeHeatmap();" value="关闭热力图"/>
	</div>
</body>
</html>
<script type="text/javascript">
    var map = new BMap.Map("container");          // 创建地图实例

    var point = new BMap.Point(116.418261, 39.921984);
    map.centerAndZoom(point, 15);             // 初始化地图，设置中心点坐标和地图级别
    map.enableScrollWheelZoom(); // 允许滚轮缩放
    //这里如何使用上面函数获取的json数据
    var points =[{"lng": 108.92779999011904, "lat": 34.22987428527369, "count": 1}, {"lng": 117.29432078447255, "lat": 31.866841501542257, "count": 1}, {"lng": 126.59025453923977, "lat": 45.66612348458037, "count": 1}, {"lng": 114.52836740104746, "lat": 38.05560223837675, "count": 1}, {"lng": 113.73812600027483, "lat": 34.78195396873758, "count": 1}, {"lng": 123.41537632671833, "lat": 41.84891320457334, "count": 1}, {"lng": 123.41537632671833, "lat": 41.84891320457334, "count": 1}, {"lng": 104.06249455844603, "lat": 30.54354292713157, "count": 1}, {"lng": 126.79204413625399, "lat": 45.71044932235944, "count": 1}, {"lng": 103.8102901616868, "lat": 30.6980549641586, "count": 1}, {"lng": 108.95382191458961, "lat": 34.24445874810537, "count": 1}, {"lng": 108.90689413471432, "lat": 34.24564855996037, "count": 1}, {"lng": 117.42007901224021, "lat": 39.160424512125026, "count": 1}, {"lng": 109.85905775635666, "lat": 40.663848126562904, "count": 1}, {"lng": 114.11542927982413, "lat": 22.557065986746295, "count": 1}, {"lng": 114.51456581183622, "lat": 37.0728663613149, "count": 1}, {"lng": 116.3324434062659, "lat": 39.951939518935816, "count": 1}, {"lng": 104.07481380792167, "lat": 30.55865112311754, "count": 1}, {"lng": 108.92779999011904, "lat": 34.22987428527369, "count": 1}, {"lng": 126.79204413625399, "lat": 45.71044932235944, "count": 1}, {"lng": 104.69166569578617, "lat": 31.45474939216445, "count": 1}, {"lng": 117.29432078447255, "lat": 31.866841501542257, "count": 1}, {"lng": 108.90689413471432, "lat": 34.24564855996037, "count": 1}, {"lng": 113.7757458456762, "lat": 34.77703628632606, "count": 1}, {"lng": 112.55915190275842, "lat": 37.844329401130416, "count": 1}, {"lng": 123.44286022659192, "lat": 41.80802435838824, "count": 1}, {"lng": 125.41964874071088, "lat": 43.73219054084285, "count": 1}, {"lng": 116.50502846592885, "lat": 39.91100864727368, "count": 1}, {"lng": 108.90689413471432, "lat": 34.24564855996037, "count": 1}, {"lng": 104.06792346330406, "lat": 30.679942845419564, "count": 1}, {"lng": 113.3856428913265, "lat": 23.166129265424512, "count": 1}, {"lng": 104.639679777693, "lat": 23.68721811528129, "count": 1}, {"lng": 117.06223457021973, "lat": 36.668217100754845, "count": 1}, {"lng": 113.93001313569306, "lat": 22.707432793082347, "count": 1}, {"lng": 116.36507707218831, "lat": 39.937655744594224, "count": 1}, {"lng": 113.7080112503753, "lat": 34.797406405145374, "count": 1}, {"lng": 108.88213852187708, "lat": 34.24380003096026, "count": 1}, {"lng": 108.92779999011904, "lat": 34.22987428527369, "count": 1}, {"lng": 104.08324011841893, "lat": 30.632008965702994, "count": 1}, {"lng": 106.53063501341296, "lat": 29.54460610888615, "count": 1}, {"lng": 113.3948175587587, "lat": 23.40800372902474, "count": 1}, {"lng": 113.56971101492486, "lat": 34.83041147893635, "count": 1}, {"lng": 126.67516032251702, "lat": 45.758396840049045, "count": 1}, {"lng": 108.92336517529091, "lat": 34.23160835047327, "count": 1}, {"lng": 114.25346109840619, "lat": 30.62574400478327, "count": 1}, {"lng": 120.60683748357427, "lat": 31.317559349471637, "count": 1}, {"lng": 121.37624801589295, "lat": 31.243034774325526, "count": 1}, {"lng": 120.31449815396884, "lat": 31.576745982854952, "count": 1}, {"lng": 113.7757458456762, "lat": 34.77703628632606, "count": 1}, {"lng": 120.60764129273444, "lat": 31.317162450966993, "count": 1}, {"lng": 119.64736309147122, "lat": 39.94453274479183, "count": 1}, {"lng": 126.79204413625399, "lat": 45.71044932235944, "count": 1}, {"lng": 112.55915190275842, "lat": 37.844329401130416, "count": 1}, {"lng": 121.59347778143518, "lat": 38.94870993830429, "count": 1}, {"lng": 120.39380442710338, "lat": 36.27212339862869, "count": 1}, {"lng": 112.99334526138817, "lat": 28.190258680105458, "count": 1}, {"lng": 114.47110676502666, "lat": 38.030614416030666, "count": 1}, {"lng": 103.8233054407292, "lat": 36.06422552504259, "count": 1}, {"lng": 126.79204413625399, "lat": 45.71044932235944, "count": 1}, {"lng": 110.33409898438751, "lat": 20.029706076727884, "count": 1}, {"lng": 123.41537632671833, "lat": 41.84891320457334, "count": 1}, {"lng": 109.50378929072508, "lat": 35.860026261322766, "count": 1}, {"lng": 104.06443967463798, "lat": 30.665387090745668, "count": 1}, {"lng": 120.07441190931887, "lat": 30.33474665928496, "count": 1}, {"lng": 108.95264222116678, "lat": 34.256488243764224, "count": 1}, {"lng": 108.96625890407014, "lat": 34.255484557670755, "count": 1}, {"lng": 117.35391279996986, "lat": 31.790724288122163, "count": 1}, {"lng": 113.89815601211272, "lat": 22.57269372097595, "count": 1}, {"lng": 115.66665700011858, "lat": 37.724217886080204, "count": 1}, {"lng": 103.24397209863538, "lat": 29.838678753844903, "count": 1}, {"lng": 113.02096885648916, "lat": 28.203810552354742, "count": 1}, {"lng": 114.53174163147523, "lat": 36.6305719979901, "count": 1}, {"lng": 113.68960371284814, "lat": 34.75893099050628, "count": 1}, {"lng": 123.41537632671833, "lat": 41.84891320457334, "count": 1}, {"lng": 103.8233054407292, "lat": 36.06422552504259, "count": 1}, {"lng": 112.99152644245999, "lat": 28.204510343207016, "count": 1}, {"lng": 104.639679777693, "lat": 23.68721811528129, "count": 1}, {"lng": 104.0418568535242, "lat": 30.63056600844878, "count": 1}, {"lng": 107.49497344658866, "lat": 31.214198858944734, "count": 1}, {"lng": 104.07235166031549, "lat": 30.55804199593519, "count": 1}, {"lng": 108.95264222116678, "lat": 34.256488243764224, "count": 1}, {"lng": 114.44615739289804, "lat": 38.02139383787344, "count": 1}, {"lng": 108.95264222116678, "lat": 34.256488243764224, "count": 1}, {"lng": 125.29851002173238, "lat": 43.852265240032985, "count": 1}, {"lng": 104.07481380792167, "lat": 30.55865112311754, "count": 1}, {"lng": 103.8877697305668, "lat": 36.05391965273599, "count": 1}, {"lng": 108.95382191458961, "lat": 34.24445874810537, "count": 1}, {"lng": 123.49892677690912, "lat": 41.83527908077473, "count": 1}, {"lng": 109.03804456347515, "lat": 32.70437044999437, "count": 1}, {"lng": 103.24397209863538, "lat": 29.838678753844903, "count": 1}, {"lng": 104.07481380792167, "lat": 30.55865112311754, "count": 1}, {"lng": 104.06443967463798, "lat": 30.665387090745668, "count": 1}, {"lng": 117.12620134664701, "lat": 39.03506461148468, "count": 1}, {"lng": 112.55915190275842, "lat": 37.844329401130416, "count": 1}, {"lng": 116.3324434062659, "lat": 39.951939518935816, "count": 1}, {"lng": 112.5604955189707, "lat": 37.81359944836932, "count": 1}, {"lng": 113.33590618667087, "lat": 23.205315232425356, "count": 1}, {"lng": 108.95264222116678, "lat": 34.256488243764224, "count": 1}, {"lng": 116.28714797416332, "lat": 39.83263427192748, "count": 1}, {"lng": 112.59439045613425, "lat": 37.82988454857294, "count": 1}, {"lng": 104.639679777693, "lat": 23.68721811528129, "count": 1}, {"lng": 108.95264222116678, "lat": 34.256488243764224, "count": 1}, {"lng": 112.9793527876505, "lat": 28.21347823085322, "count": 1}, {"lng": 123.43384737380006, "lat": 41.76994787745166, "count": 1}, {"lng": 117.26401155232841, "lat": 31.860694690660644, "count": 1}, {"lng": 120.7427515105731, "lat": 31.272122166933304, "count": 1}, {"lng": 113.8412643479125, "lat": 22.638655652154196, "count": 1}, {"lng": 108.95264222116678, "lat": 34.256488243764224, "count": 1}, {"lng": 118.78339538237492, "lat": 31.9819775627626, "count": 1}, {"lng": 120.60683748357427, "lat": 31.317559349471637, "count": 1}, {"lng": 104.08324011841893, "lat": 30.632008965702994, "count": 1}, {"lng": 123.41537632671833, "lat": 41.84891320457334, "count": 1}, {"lng": 113.02096885648916, "lat": 28.203810552354742, "count": 1}, {"lng": 116.16534286645341, "lat": 40.071736300742096, "count": 1}, {"lng": 117.1792158856767, "lat": 31.866330151383153, "count": 1}, {"lng": 104.11873944359618, "lat": 30.623813222280514, "count": 1}, {"lng": 120.39380442710338, "lat": 36.27212339862869, "count": 1}, {"lng": 108.95264222116678, "lat": 34.256488243764224, "count": 1}, {"lng": 117.23992421051938, "lat": 31.82194569806865, "count": 1}, {"lng": 126.79204413625399, "lat": 45.71044932235944, "count": 1}, {"lng": 113.33590618667087, "lat": 23.205315232425356, "count": 1}, {"lng": 117.16928698530208, "lat": 39.12025223039869, "count": 1}, {"lng": 113.71476171355383, "lat": 34.78235062774227, "count": 1}, {"lng": 123.44018918612413, "lat": 41.81336748460637, "count": 1}, {"lng": 116.1591436376714, "lat": 40.07011975489843, "count": 1}, {"lng": 114.25346109840619, "lat": 30.62574400478327, "count": 1}, {"lng": 113.64964384986449, "lat": 34.756610064140254, "count": 1}, {"lng": 117.24231064983549, "lat": 31.84681439716978, "count": 1}, {"lng": 114.52208184420766, "lat": 38.048958314615454, "count": 1}, {"lng": 108.92779999011904, "lat": 34.22987428527369, "count": 1}, {"lng": 120.60683748357427, "lat": 31.317559349471637, "count": 1}, {"lng": 113.63304815951703, "lat": 34.75929710336264, "count": 1}, {"lng": 108.92779999011904, "lat": 34.22987428527369, "count": 1}, {"lng": 116.273897961603, "lat": 40.22596303916501, "count": 1}, {"lng": 104.06443967463798, "lat": 30.665387090745668, "count": 1}, {"lng": 107.17064545238307, "lat": 34.36408080974784, "count": 1}, {"lng": 104.08083910589254, "lat": 30.639241934878683, "count": 1}, {"lng": 108.92779999011904, "lat": 34.22987428527369, "count": 1}, {"lng": 104.06443967463798, "lat": 30.665387090745668, "count": 1}, {"lng": 108.92779999011904, "lat": 34.22987428527369, "count": 1}, {"lng": 125.34489933527382, "lat": 43.998252407950645, "count": 1}, {"lng": 106.64462317074081, "lat": 29.49030808754362, "count": 1}, {"lng": 120.60588530129301, "lat": 31.315048742726955, "count": 1}, {"lng": 123.44018918612413, "lat": 41.81336748460637, "count": 1}, {"lng": 108.95264222116678, "lat": 34.256488243764224, "count": 1}, {"lng": 108.697660705737, "lat": 34.34841904444591, "count": 1}, {"lng": 120.17889803893216, "lat": 30.28624461425988, "count": 1}, {"lng": 108.92779999011904, "lat": 34.22987428527369, "count": 1}, {"lng": 108.92779999011904, "lat": 34.22987428527369, "count": 1}, {"lng": 113.7751519516493, "lat": 34.775965239868356, "count": 1}, {"lng": 104.09534776035373, "lat": 30.653733467524496, "count": 1}, {"lng": 106.68891115654719, "lat": 35.550110190016646, "count": 1}, {"lng": 113.35032291319143, "lat": 34.088267231987096, "count": 1}, {"lng": 104.639679777693, "lat": 23.68721811528129, "count": 1}, {"lng": 116.3324434062659, "lat": 39.951939518935816, "count": 1}, {"lng": 113.33590618667087, "lat": 23.205315232425356, "count": 1}, {"lng": 106.54696678482918, "lat": 29.55523619439504, "count": 1}, {"lng": 104.06791210602749, "lat": 30.582049366246608, "count": 1}, {"lng": 108.90689413471432, "lat": 34.24564855996037, "count": 1}, {"lng": 126.79204413625399, "lat": 45.71044932235944, "count": 1}, {"lng": 113.41902801422819, "lat": 23.178870622563462, "count": 1}, {"lng": 104.06443967463798, "lat": 30.665387090745668, "count": 1}, {"lng": 126.59025453923977, "lat": 45.66612348458037, "count": 1}, {"lng": 113.02096885648916, "lat": 28.203810552354742, "count": 1}, {"lng": 118.79090328867471, "lat": 32.04559473265414, "count": 1}, {"lng": 123.4277940630702, "lat": 41.83370111070768, "count": 1}, {"lng": 119.64736309147122, "lat": 39.94453274479183, "count": 1}, {"lng": 126.59025453923977, "lat": 45.66612348458037, "count": 1}, {"lng": 118.78339538237492, "lat": 31.9819775627626, "count": 1}, {"lng": 110.15167631614493, "lat": 22.643973608377276, "count": 1}, {"lng": 121.63336874438623, "lat": 31.216379222845987, "count": 1}, {"lng": 123.41537632671833, "lat": 41.84891320457334, "count": 1}, {"lng": 108.92779999011904, "lat": 34.22987428527369, "count": 1}, {"lng": 123.44018918612413, "lat": 41.81336748460637, "count": 1}, {"lng": 108.95264222116678, "lat": 34.256488243764224, "count": 1}, {"lng": 108.92779999011904, "lat": 34.22987428527369, "count": 1}, {"lng": 108.92779999011904, "lat": 34.22987428527369, "count": 1}, {"lng": 102.45762459933961, "lat": 38.10326734375233, "count": 1}, {"lng": 108.92779999011904, "lat": 34.22987428527369, "count": 1}, {"lng": 113.42041168588273, "lat": 23.17818977433878, "count": 1}];


    /*底下的读取本地json貌似不被允许运行 貌似智能动态指定了
    $.getJSON("D:\\python\\whatJob\\Golangjinwei.json",function(data){
        $.each(data,function(i,info){
            points.push(info);
        })
    })*/



    if(!isSupportCanvas()){
    	alert('热力图目前只支持有canvas支持的浏览器,您所使用的浏览器不能使用热力图功能~')
    }
	//详细的参数,可以查看heatmap.js的文档 https://github.com/pa7/heatmap.js/blob/master/README.md
	//参数说明如下:
	/* visible 热力图是否显示,默认为true
     * opacity 热力的透明度,1-100
     * radius 势力图的每个点的半径大小
     * gradient  {JSON} 热力图的渐变区间 . gradient如下所示
     *	{
			.2:'rgb(0, 255, 255)',
			.5:'rgb(0, 110, 255)',
			.8:'rgb(100, 0, 255)'
		}
		其中 key 表示插值的位置, 0~1.
		    value 为颜色值.
     */
	heatmapOverlay = new BMapLib.HeatmapOverlay({"radius":20});
	map.addOverlay(heatmapOverlay);
	//这里max是我设置的，因为目前的权值 count都是1
	heatmapOverlay.setDataSet({data:points,max:2});
	//是否显示热力图
    function openHeatmap(){
        heatmapOverlay.show();
    }
	function closeHeatmap(){
        heatmapOverlay.hide();
    }
	closeHeatmap();
    function setGradient(){
     	/*格式如下所示:
		{
	  		0:'rgb(102, 255, 0)',
	 	 	.5:'rgb(255, 170, 0)',
		  	1:'rgb(255, 0, 0)'
		}*/
     	var gradient = {};
     	var colors = document.querySelectorAll("input[type='color']");
     	colors = [].slice.call(colors,0);
     	colors.forEach(function(ele){
			gradient[ele.getAttribute("data-key")] = ele.value;
     	});
        heatmapOverlay.setOptions({"gradient":gradient});
    }
	//判断浏览区是否支持canvas
    function isSupportCanvas(){
        var elem = document.createElement('canvas');
        return !!(elem.getContext && elem.getContext('2d'));
    }
</script>